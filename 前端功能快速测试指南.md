# 前端功能快速测试指南

## 📋 前置准备

### 1. 修复npm权限（如果需要）

如果遇到权限错误：

```bash
sudo chown -R 501:20 "/Users/ahyk/.npm"
```

### 2. 安装ECharts

```bash
cd /Users/ahyk/data/ai/caipiao/frontend
npm install echarts
```

验证安装成功：

```bash
npm list echarts
```

应该看到类似输出：

```
frontend@0.0.0 /Users/ahyk/data/ai/caipiao/frontend
└── echarts@5.x.x
```

## 🚀 启动测试

### 1. 启动后端

```bash
cd /Users/ahyk/data/ai/caipiao/backend
go run main.go
```

或者使用已编译的版本：

```bash
cd /Users/ahyk/data/ai/caipiao/backend
./caipiao
```

验证后端启动成功：

```
2025/10/29 16:30:00 数据库连接成功
2025/10/29 16:30:00 服务器启动在端口: 8080
```

### 2. 启动前端

新开一个终端窗口：

```bash
cd /Users/ahyk/data/ai/caipiao/frontend
npm run dev
```

验证前端启动成功：

```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

### 3. 浏览器访问

打开浏览器，访问：`http://localhost:5173`

## ✅ 测试清单

### 测试1：异步任务进度条

#### 步骤：

1. 访问"双色球"页面
2. 点击"批量获取历史数据"按钮
3. 输入期数：**200**（触发异步）
4. 点击"开始获取"

#### 预期结果：

- ✅ 显示提示："任务已创建，正在后台获取数据..."
- ✅ 对话框保持打开，显示进度：
  ```
  总计：200
  成功：逐步增加（0 → 50 → 100 → 200）
  跳过：0（如果之前没有数据）
  失败：0
  ```
- ✅ 约1-2分钟后完成
- ✅ 显示成功消息："批量获取完成！成功 200 期"
- ✅ 列表自动刷新，显示新数据

#### 后端日志（参考）：

```
2025/10/29 16:35:00 创建异步任务: task_xxx
2025/10/29 16:35:00 开始批量获取双色球历史数据，共 200 期
2025/10/29 16:35:05 双色球 2024001 保存成功
2025/10/29 16:35:05 双色球 2024002 保存成功
...
2025/10/29 16:36:30 双色球批量获取完成: 总计=200, 成功=200, 跳过=0, 失败=0
2025/10/29 16:36:30 任务完成: task_xxx
```

---

### 测试2：同步任务（对比）

#### 步骤：

1. 访问"大乐透"页面
2. 点击"批量获取历史数据"
3. 输入期数：**50**（同步）
4. 点击"开始获取"

#### 预期结果：

- ✅ 直接显示进度（无"任务已创建"提示）
- ✅ 约10-20秒完成
- ✅ 立即显示结果统计
- ✅ 列表自动刷新

---

### 测试3：走势图 - 双色球

#### 步骤：

1. 点击顶部菜单"双色球" → "走势分析"
2. 等待数据加载

#### 预期结果：

- ✅ 显示"双色球号码走势图"
- ✅ 折线图显示7条曲线（红球1-6，蓝球）
- ✅ X轴显示期号，旋转45度
- ✅ Y轴范围0-35
- ✅ 鼠标悬停显示详细数据

#### 测试交互：

1. 切换期数为"最近100期"
   - ✅ 图表重新加载
   - ✅ 显示"共100期"

2. 点击"刷新数据"
   - ✅ 显示加载状态
   - ✅ 数据重新加载

3. 调整浏览器窗口大小
   - ✅ 图表自动适应

---

### 测试4：频率分析

#### 预期结果：

**红球频率统计（Top 10）**：

- ✅ 柱状图显示10个柱子
- ✅ 红色渐变（#f56c6c → #e74c3c）
- ✅ X轴：号码（1-33）
- ✅ Y轴：出现次数
- ✅ 表格显示：
  ```
  号码 | 出现次数 | 出现率
  15   | 28       | 9.3%
  22   | 26       | 8.7%
  ...
  ```

**蓝球频率统计（Top 10）**：

- ✅ 柱状图显示10个柱子
- ✅ 蓝色渐变（#409eff → #3498db）
- ✅ 表格显示出现率

---

### 测试5：遗漏值提醒

#### 预期结果：

**红球遗漏值（Top 10）**：

- ✅ 表格显示10个号码
- ✅ 遗漏期数标签（颜色对应）：
  - 0期：绿色"成功"
  - 1-9期：蓝色"信息"
  - 10-19期：橙色"警告"
  - 20+期：红色"危险"
- ✅ 状态显示：
  - "●刚出现"（绿色）
  - "●正常"（蓝色）
  - "●较长"（橙色）
  - "●长期未出"（红色）

**长期遗漏提醒**：

- ✅ 如果最大遗漏值>20期，显示警告框：
  ```
  ⚠️ 长期遗漏提醒
  号码 7 已连续 25 期未出现！
  ```

---

### 测试6：走势图 - 大乐透

#### 步骤：

1. 点击顶部菜单"大乐透" → "走势分析"

#### 预期结果：

- ✅ 显示"大乐透号码走势图"
- ✅ 折线图显示7条曲线（前区1-5，后区1-2）
- ✅ Y轴范围0-40（前区最大35）
- ✅ 前区：红色系列
- ✅ 后区：蓝色系列

**前区频率统计**：

- ✅ 红色渐变柱状图
- ✅ 出现率计算：(次数 / (期数 * 5)) * 100%

**后区频率统计**：

- ✅ 蓝色渐变柱状图
- ✅ 出现率计算：(次数 / (期数 * 2)) * 100%

**遗漏值提醒**：

- ✅ 后区遗漏>10期显示警告

---

## 🎯 完整测试流程

### 场景：从零开始

```bash
# 1. 启动后端
cd /Users/ahyk/data/ai/caipiao/backend
go run main.go

# 2. 新终端，启动前端
cd /Users/ahyk/data/ai/caipiao/frontend
npm install echarts
npm run dev

# 3. 浏览器访问
open http://localhost:5173
```

### 操作步骤：

#### 第一步：获取双色球数据

1. 访问"双色球"页面
2. 点击"批量获取历史数据"
3. 输入：200期
4. 点击"开始获取"
5. 等待2分钟，任务完成
6. 验证列表显示200条记录

#### 第二步：查看双色球走势

1. 点击"双色球" → "走势分析"
2. 默认显示最近50期
3. 查看走势图
4. 查看频率统计
5. 查看遗漏值

#### 第三步：切换期数

1. 选择"最近100期"
2. 点击"刷新数据"
3. 验证图表更新

#### 第四步：获取大乐透数据

1. 点击"大乐透" → "开奖记录"
2. 点击"批量获取历史数据"
3. 输入：200期
4. 等待任务完成

#### 第五步：查看大乐透走势

1. 点击"大乐透" → "走势分析"
2. 验证所有功能

---

## 📸 预期界面截图说明

### 双色球走势图页面

```
┌──────────────────────────────────────────────────────┐
│ 🏆 彩票数据管理系统                                   │
│ [双色球 ▼] [大乐透 ▼]                                 │
├──────────────────────────────────────────────────────┤
│                                                       │
│  [最近50期 ▼]  [🔄 刷新数据]                          │
│                                                       │
│  ┌────────────────────────────────────────────────┐ │
│  │ 双色球号码走势图                     共 50 期   │ │
│  │ ┌──────────────────────────────────────────┐  │ │
│  │ │ 35 ─┬───────────────────────────────────┤  │ │
│  │ │     │  ╱╲   ╱╲      ╱╲                   │  │ │
│  │ │ 20 ─┤ ╱  ╲ ╱  ╲╱╲  ╱  ╲   红球1-6       │  │ │
│  │ │     │╱    ╲     ╲╱    ╲  蓝球           │  │ │
│  │ │  0 ─┴──────────────────────────────────┤  │ │
│  │ │    2024100  2024110  2024120  2024130   │  │ │
│  │ └──────────────────────────────────────────┘  │ │
│  └────────────────────────────────────────────────┘ │
│                                                       │
│  ┌───────────────────┐ ┌──────────────────────────┐ │
│  │ 红球频率统计      │ │ 蓝球频率统计             │ │
│  │ (Top 10)          │ │ (Top 10)                 │ │
│  │ ┌───────────────┐ │ │ ┌──────────────────────┐ │ │
│  │ │ 柱状图        │ │ │ │ 柱状图               │ │ │
│  │ │ (红色渐变)    │ │ │ │ (蓝色渐变)           │ │ │
│  │ └───────────────┘ │ │ └──────────────────────┘ │ │
│  │ ┌───────────────┐ │ │ ┌──────────────────────┐ │ │
│  │ │号码 次数 出现率│ │ │ │号码 次数 出现率      │ │ │
│  │ │ 15   28  9.3%  │ │ │ │ 05   12  24.0%       │ │ │
│  │ │ 22   26  8.7%  │ │ │ │ 10   10  20.0%       │ │ │
│  │ └───────────────┘ │ │ └──────────────────────┘ │ │
│  └───────────────────┘ └──────────────────────────┘ │
│                                                       │
│  ┌───────────────────┐ ┌──────────────────────────┐ │
│  │ 红球遗漏值        │ │ 蓝球遗漏值               │ │
│  │ (Top 10)          │ │ (Top 10)                 │ │
│  │ ⚠️ 长期遗漏提醒    │ │                          │ │
│  │ 号码7已连续25期未  │ │ ⚠️ 长期遗漏提醒          │ │
│  │ 出现！            │ │ 号码3已连续12期未出现！  │ │
│  │ ┌───────────────┐ │ │ ┌──────────────────────┐ │ │
│  │ │号码 遗漏 状态  │ │ │ │号码 遗漏 状态        │ │ │
│  │ │ 07  [25期]危险│ │ │ │ 03  [12期]危险       │ │ │
│  │ │ 13  [18期]警告│ │ │ │ 08  [8期]警告        │ │ │
│  │ │ 28  [5期]正常 │ │ │ │ 05  [0期]刚出现      │ │ │
│  │ └───────────────┘ │ │ └──────────────────────┘ │ │
│  └───────────────────┘ └──────────────────────────┘ │
│                                                       │
└──────────────────────────────────────────────────────┘
```

---

## 🐛 常见问题排查

### 问题1：走势图页面空白

**排查步骤**：

1. 检查浏览器控制台（F12）
2. 查看是否有错误：`echarts is not defined`

**解决方法**：

```bash
cd /Users/ahyk/data/ai/caipiao/frontend
npm install echarts
npm run dev
```

---

### 问题2：走势图显示"无数据"

**原因**：数据库没有数据

**解决方法**：

1. 先获取历史数据（至少30期）
2. 再访问走势图

---

### 问题3：异步任务一直pending

**排查步骤**：

1. 查看后端日志
2. 确认后端是否在处理任务

**可能原因**：

- 后端处理较慢（大数据量）
- 网络请求被限流

**解决方法**：

- 耐心等待（最多5分钟）
- 查看后端日志确认进度

---

### 问题4：频率统计为0

**原因**：获取的数据期数太少

**解决方法**：

- 至少获取50期数据
- 获取更多数据（100-200期）

---

### 问题5：图表不响应窗口大小

**原因**：浏览器兼容性问题

**解决方法**：

1. 刷新页面
2. 使用Chrome/Edge最新版

---

## ✅ 测试完成检查表

### 异步任务
- [ ] 超过100期触发异步
- [ ] 进度实时更新
- [ ] 任务完成后刷新列表
- [ ] 错误处理正常

### 走势图
- [ ] 双色球走势图正常显示
- [ ] 大乐透走势图正常显示
- [ ] 切换期数正常
- [ ] 刷新功能正常
- [ ] 窗口缩放适配

### 频率分析
- [ ] 柱状图正常显示
- [ ] 颜色渐变正确
- [ ] 表格数据正确
- [ ] 出现率计算正确

### 遗漏值
- [ ] 遗漏值计算正确
- [ ] 状态标签正确
- [ ] 长期遗漏提醒正常
- [ ] 颜色标记正确

---

## 🎉 测试成功标志

所有功能测试通过后，您应该能够：

1. ✅ 批量获取200期数据（异步）
2. ✅ 查看实时进度
3. ✅ 查看双色球走势图
4. ✅ 查看大乐透走势图
5. ✅ 切换不同期数
6. ✅ 查看频率统计
7. ✅ 查看遗漏值提醒
8. ✅ 所有图表响应式正常

恭喜！所有前端功能测试完成！🎊

---

## 📚 相关文档

- `frontend/前端新功能使用指南.md` - 详细使用指南
- `前端功能完成总结.md` - 功能总结
- `历史数据优化和走势图功能说明.md` - 后端API文档

