# 走势图优化说明

## 🎨 优化内容

### 从 ECharts 折线图改为传统走势表格

**优化前**：
- 使用 ECharts 绘制7条折线图
- 号码走势不够直观
- 难以快速定位号码

**优化后**：
- 传统彩票走势表格布局
- 期号从上到下排列（最新在上）
- 号码从左到右展示（1-33红球 + 1-16蓝球）
- 每期开出的号码用彩色圆球标注
- 相邻期相同号码用线条连接

## 📊 走势表格设计

### 双色球走势图结构

```
┌──────┬────────┬───────────────────────────────────┬────────────────┐
│ 期号 │开奖日期│        红球区(1-33)               │  蓝球区(1-16)  │
├──────┼────────┼───┬───┬───┬───┬───┬───┬───┬───────┼───┬───┬───┬───┤
│      │        │01 │02 │03 │...│31 │32 │33 │01 │02 │...│15 │16 │
├──────┼────────┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│2024100│ 10-29 │   │ ●│   │   │ ● │   │   │   │ ● │   │   │   │
│      │        │   │ | │   │   │ | │   │   │   │ | │   │   │   │
├──────┼────────┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│2024099│ 10-27 │ ● │ | │   │ ● │ | │   │   │ ● │ | │   │   │   │
│      │        │ | │ | │   │ | │ | │   │   │ | │ | │   │   │   │
├──────┼────────┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│2024098│ 10-25 │ | │ ● │   │ | │ ● │   │   │ | │ ● │   │   │   │
└──────┴────────┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
```

**说明**：
- ● = 当期开出的号码（红色/蓝色圆球）
- | = 连接线（表示连续两期都开出该号码）
- 数字 = 未开出的号码（灰色显示）

### 大乐透走势图结构

```
┌──────┬────────┬────────────────────────────────────┬─────────────┐
│ 期号 │开奖日期│       前区(1-35)                   │  后区(1-12) │
├──────┼────────┼───┬───┬───┬───┬───┬───┬───┬────────┼───┬───┬───┤
│      │        │01 │02 │03 │...│33 │34 │35 │01 │02 │...│11 │12 │
├──────┼────────┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│25122 │ 10-27  │   │ ●│   │   │ ● │   │   │   │ ● │   │   │   │
└──────┴────────┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
```

## 🎯 功能特点

### 1. 表格布局
- ✅ 期号从上到下排列（默认50期）
- ✅ 号码从左到右展示
- ✅ 期号和日期固定列（横向滚动时保持可见）
- ✅ 表头固定（纵向滚动时保持可见）

### 2. 视觉标注
- ✅ 开出号码：彩色圆球显示
  - 红球/前区：红色渐变圆球
  - 蓝球/后区：蓝色渐变圆球
- ✅ 未开出号码：灰色小字显示
- ✅ 连接线：红色/蓝色竖线连接相邻期相同号码

### 3. 交互体验
- ✅ 横向/纵向滚动
- ✅ 鼠标悬停高亮行
- ✅ 期数切换（30/50/100期）
- ✅ 响应式布局

## 💻 技术实现

### 核心代码结构

```vue
<template>
  <!-- 走势表格 -->
  <table class="trend-table">
    <thead>
      <!-- 分组表头：红球区、蓝球区 -->
      <tr>
        <th colspan="33">红球区</th>
        <th colspan="16">蓝球区</th>
      </tr>
      <!-- 号码表头：01-33, 01-16 -->
      <tr>
        <th v-for="num in 33">{{ num }}</th>
        <th v-for="num in 16">{{ num }}</th>
      </tr>
    </thead>
    <tbody>
      <tr v-for="(row, rowIndex) in tableData">
        <td class="period-cell">{{ row.issue }}</td>
        <td class="date-cell">{{ formatDate(row.draw_date) }}</td>
        
        <!-- 每个号码单元格 -->
        <td v-for="num in 33" class="trend-cell">
          <!-- 开出号码：显示彩色圆球 -->
          <span v-if="row.red_balls.includes(num)" class="ball-mark">
            {{ num }}
          </span>
          <!-- 未开出：显示灰色数字 -->
          <span v-else class="empty-mark">{{ num }}</span>
          
          <!-- 连接线：判断当前期和下一期是否都开出该号码 -->
          <svg v-if="hasConnection(rowIndex, num, 'red')" class="connect-line">
            <line x1="1" y1="0" x2="1" y2="40" stroke="#f56c6c" />
          </svg>
        </td>
      </tr>
    </tbody>
  </table>
</template>

<script>
// 判断是否需要连接线
const hasConnection = (rowIndex, num, type) => {
  const currentRow = tableData.value[rowIndex]
  const nextRow = tableData.value[rowIndex + 1]
  
  if (type === 'red') {
    return currentRow.red_balls.includes(num) && nextRow.red_balls.includes(num)
  } else {
    return currentRow.blue_ball === num && nextRow.blue_ball === num
  }
}
</script>
```

### CSS 样式要点

```css
/* 固定表头 */
.trend-table thead {
  position: sticky;
  top: 0;
  z-index: 10;
}

/* 固定期号和日期列 */
.period-cell {
  position: sticky;
  left: 0;
  z-index: 1;
}

.date-cell {
  position: sticky;
  left: 80px;
  z-index: 1;
}

/* 彩色号码球 */
.ball-mark {
  display: inline-flex;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, #f56c6c, #e74c3c);
  color: #fff;
}

/* 连接线 */
.connect-line {
  position: absolute;
  width: 2px;
  height: 40px;
  pointer-events: none;
}
```

## 📝 修改文件

- ✅ `frontend/src/views/ShuangseqiuTrend.vue` - 完全重写
- ✅ `frontend/src/views/DaletouTrend.vue` - 完全重写

## 🎨 视觉效果

### 期号排列
```
最新 → 2024100 (10-29)
      2024099 (10-27)
      2024098 (10-25)
      ...
最旧 → 2024051 (06-01)
```

### 号码标注
- **开出号码**：🔴 红色圆球 / 🔵 蓝色圆球
- **未开出**：淡灰色数字
- **连接线**：红色/蓝色竖线

### 配色方案
- **红球/前区**：
  - 背景：`#fef0f0` ~ `#fde2e2` 渐变
  - 球体：`#f56c6c` ~ `#e74c3c` 渐变
  - 连线：`#f56c6c` 实线

- **蓝球/后区**：
  - 背景：`#ecf5ff` ~ `#d9ecff` 渐变
  - 球体：`#409eff` ~ `#3498db` 渐变
  - 连线：`#409eff` 实线

## ✅ 优化完成检查表

### 双色球走势图
- [x] 表格布局实现
- [x] 期号从上到下排列
- [x] 号码从左到右展示（33红球 + 16蓝球）
- [x] 开出号码彩色球标注
- [x] 连接线逻辑实现
- [x] 固定表头和列
- [x] 样式优化
- [x] 响应式布局
- [x] 默认50期，可切换30/50/100期

### 大乐透走势图
- [x] 表格布局实现
- [x] 期号从上到下排列
- [x] 号码从左到右展示（35前区 + 12后区）
- [x] 开出号码彩色球标注
- [x] 连接线逻辑实现
- [x] 固定表头和列
- [x] 样式优化
- [x] 响应式布局
- [x] 默认50期，可切换30/50/100期

## 🎯 使用说明

1. 访问"双色球" → "走势图"
2. 默认显示最近50期
3. 可切换30/50/100期
4. 横向滚动查看所有号码
5. 纵向滚动查看更多期数
6. 红色/蓝色圆球表示开出号码
7. 竖线表示连续开出

## 📊 数据格式

### API响应（需要后端支持）

```javascript
{
  "issues": ["2024100", "2024099", ...],
  "draw_dates": ["2024-10-29", "2024-10-27", ...],
  "red_balls": [
    [2, 5, 12, 18, 25, 33],  // 2024100期
    [1, 8, 15, 20, 28, 30],  // 2024099期
    ...
  ],
  "blue_balls": [5, 10, ...]
}
```

### 前端处理

```javascript
tableData.value = data.issues.map((issue, index) => ({
  issue: issue,
  draw_date: data.draw_dates[index],
  red_balls: data.red_balls[index],
  blue_ball: data.blue_balls[index]
}))
```

## 🎉 优化优势

**对比折线图**：
- ❌ 折线图：需要查看图例才知道是哪个号码
- ✅ 表格：直接看号码位置，一目了然

**对比原有展示**：
- ❌ 只展示开奖结果：看不出号码规律
- ✅ 走势表格：直观看出号码冷热、连续性

**传统彩票玩家熟悉**：
- ✅ 符合彩票店走势图习惯
- ✅ 更容易分析号码趋势
- ✅ 快速定位热号、冷号

